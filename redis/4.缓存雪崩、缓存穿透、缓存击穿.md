# 缓存雪崩、缓存穿透、缓存击穿

## 缓存雪崩

### 发生

1.redis主机挂了，redis全盘崩溃

2.比如缓存中有大量数据同时过期

### 解决

1.redis缓存集群实现高可用，一主二从+哨兵，redis cluster

2.ehcache本地缓存+Hystrx或者阿里sentinel限流&降级

3.开启redis持久化机制aof/rdb,尽快恢复缓存集群



## 缓存穿透

### 是什么

用户发送非法请求，redis无缓存，直接穿透到数据库，在高并发情况下很可能使数据库崩溃。

### 解决

1.将查询的key回写空对象缓存或者设置缺省值到redis，可以解决相同id的key，但无法解决不同id的key

2.使用Google guava布隆过滤器解决缓存穿透，建议设置误判率为0.03，一般用于单机系统

3.使用redis redisson的布隆过滤器解决缓存穿透，一般用于分布式系统

![](C:\Users\sugon\Desktop\note\redis\images\6.png)

## 缓存击穿

### 是什么

**热点key突然失效**，大量请求直接打到数据库



### 解决

1.对于热点key设置不过期

2.互斥独占锁防止击穿

3.在高并发下建议使用定时轮询，互斥更新，差异失效时间

![](C:\Users\sugon\Desktop\note\redis\images\7.png)


